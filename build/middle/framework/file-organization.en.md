# File organization

## App resources

An app contains: a [manifest](manifest.md) that describes the project configuration, an [app.ux](source-file.md) file that places the project's public source script, multiple [UX files](source-file.md) that describe the web page/custom components. The following is a typical example:

App root directory

```
├── manifest.json
├── app.ux
├── Page1
│   ├── page1.ux
├── Page2
│   ├── page2.ux
└── Common
    ├── ComponentA.ux
    ├── ComponentB.ux
    └── xxx.png
```

The files in the "Common" directory are public resource files and component files. The private source files and component files of each page, such as images, CSS, JS, etc., are placed in every web page's directory.

## File storage

The files are stored according to partitions in the application platform, currently the following partitions are supported:

1. Cache: it's used to cache files. For example, files downloaded through the fetch interface will be saved in this partition, the files cached here may be deleted by the system if storage space is insufficient.
2. Files: it's used to save smaller permanent files. The files in this partition are managed by the app itself.
3. Mass: it's used to store larger files. However, this partition can't be guaranteed to always be available.
4. Temp: it indicates a temporary file that has been mapped from outside. For security reasons, temp files are read-only and can only be obtained by calling a special API, e.g. the media.pickVideo method. Moreover, temp files are only temporarily accessible; when the app has been restarted, you can't access the temp file and must get it by calling a special API.

Moreover, app resources are processed as a special read-only partition.

## URI

URIs are used to indicate app resources and files. [Widgets](../widgets/common-events.md) and [features](../features/index.md) access the app resources and files via the URI.

| Resource type | URI                   | Read-only | Example                           | Description             |
| ------------- | --------------------- | --------- | --------------------------------- | ----------------------- |
| App resources | /path                 | Yes       | /Common/header.png                | -                       |
| Cache         | internal://cache/path | No        | internal://cache/fetch-123456.png | -                       |
| Files         | internal://files/path | No        | internal://files/image/demo.png   | -                       |
| Mass          | internal://mass/path  | No        | internal://mass/video/demo.mp4    | -                       |
| Temp          | internal://tmp/path   | Yes       | internal://tmp/xxxxx              | Generated by the system |

The characters allowed by the URI are `0-9a-zA-Z_-./%:` (not including quotation marks). `..` can't appear in the URI, the URI supports directory structure, the directory is separated by a dash '/'.

Internal URI indicates private files. That is, when an internal URI is specified, there is no need to specify an app ID, the same internal URI will indicate different files for different apps.

## Resources and file access rules

There are 2 types of app resource paths: absolute and relative paths. Paths that start with "/" are absolute paths, e.g. /Common/a.png; paths that don't start with "/" are relative paths, e.g. a.png and ../Common/a.png etc.

There 2 types of app source files: code and resource files. Code files refer to files that contain code, such as .js/.css/.ux, etc. Other files are source files, this type of file can generally only be used for data, e.g., for images, videos, etc.

1. In a code file, when importing other code files, use a relative path, e.g.: Common/component.ux.
2. In a code file, under normal circumstances, when referencing resource files (such as images, videos, etc.), a relative path should be used, e.g.: ./abc.png.
3. When importing a code file, if the import file is in the same directory as the imported file, and when the imported file references resource files, you can use relative path, but if they are not in the same directory, then you must use an absolute path. This is because when the imported file is compiled, it is copied into the import file, and after it's compiled the directory will change. For example, if the a.css file is imported by the b.ux file, and a.css is in the same directory as b.ux, when a.css references the resource file, you can write a relative path: abc.png. However, if they are not in the same directory, you must write an absolute path: /Common/abc.png. Another example is when the a.ux file is imported by the b.ux file, if the a.ux and b.ux files are in the same directory, when a.ux references the resource file, you can write a relative path: a.png. If they are not in the same directory, when a.ux references the resource file, you must write an absolute path: /Common/abc.png.
4. CSS is consistent with front-end development, use the URL (PATH) method to access the resource file, e.g. url (/Common/abc.png)

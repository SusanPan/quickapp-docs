<!DOCTYPE HTML><html lang="zh-hans"><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>Uploading and downloading</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content="
  
"name="description"><meta content="GitBook 3.2.3"name="generator"><meta content="QuickApp.cn"name="author"><link href="../../gitbook/style.css"rel="stylesheet"><link href="../../gitbook/gitbook-plugin-search-pro/search.css"rel="stylesheet"><link href="../../gitbook/gitbook-plugin-highlight-hap/website.css"rel="stylesheet"><link href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css"rel="stylesheet"><link href="../../styles/website.css"rel="stylesheet"><meta content="no-cache"http-equiv="Pragma"/><meta content="no-cache"http-equiv="Cache-Control"/><meta content="0"http-equiv="Expires"/><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="fetch.en.html"rel="next"/><link href="fetch.en.html"rel="next"/></head><body><header class="doc-header"><a href="javascript:;"class="btn doc-menu-toggle"aria-label=""><i class="fa fa-bars"aria-hidden="true"></i></a><div class="doc-logo"><a style="font-size:150%"target="_blank"title="quickapp">QuickApp</a></div><div class="doc-nav"><a href="../../">Tutorial</a> <a href="../../tools/toolkit-tools.en.html">Tools</a> <a href="../../framework/index.en.html">Framework</a> <a href="../../widgets/common-events.en.html">Widgets</a> <a href="../index.en.html"class="current">Features</a></div><div class="doc-search-bar"><div id="book-search-input"><i class="fa fa-search icon-search"aria-hidden="true"></i> <input placeholder="关键字搜索"type="text"></div></div></header><div class="doc-container"><nav class="doc-menu"role="navigation"><ul class="summary"><li class="open chapter"data-level="2.1.3.1"><a href="javascript:;">Basic functions <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.1.1"data-path="app.en.html"><a href="app.en.html">App context</a></li><li class="open chapter"data-level="2.1.3.1.2"data-path="log.en.html"><a href="log.en.html">Log printing</a></li><li class="open chapter"data-level="2.1.3.1.3"data-path="router.en.html"><a href="router.en.html">Page routing</a></li></ul></li><li class="open chapter"data-level="2.1.3.2"><a href="javascript:;">Interface interaction <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.2.1"data-path="share.en.html"><a href="share.en.html">Sharing</a></li><li class="open chapter"data-level="2.1.3.2.2"data-path="prompt.en.html"><a href="prompt.en.html">Pop-up window</a></li><li class="open chapter"data-level="2.1.3.2.3"data-path="webview.en.html"><a href="webview.en.html">Open web page</a></li><li class="open chapter"data-level="2.1.3.2.4"data-path="notification.en.html"><a href="notification.en.html">Notification message</a></li><li class="open chapter"data-level="2.1.3.2.5"data-path="vibrator.en.html"><a href="vibrator.en.html">Vibrate</a></li></ul></li><li class="open open chapter"data-level="2.1.3.3"><a href="javascript:;">Network access <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open open chapter active"data-level="2.1.3.3.1"data-path="request.en.html"><a href="request.en.html">Uploading and downloading</a></li><li class="open chapter"data-level="2.1.3.3.2"data-path="fetch.en.html"><a href="fetch.en.html">Data request</a></li></ul></li><li class="open chapter"data-level="2.1.3.4"><a href="javascript:;">File data <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.4.1"data-path="storage.en.html"><a href="storage.en.html">Data storage</a></li><li class="open chapter"data-level="2.1.3.4.2"data-path="file.en.html"><a href="file.en.html">File storage</a></li></ul></li><li class="open chapter"data-level="2.1.3.5"><a href="javascript:;">System capabilities <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.5.1"data-path="barcode.en.html"><a href="barcode.en.html">QR codes</a></li><li class="open chapter"data-level="2.1.3.5.2"data-path="sensor.en.html"><a href="sensor.en.html">Sensors</a></li><li class="open chapter"data-level="2.1.3.5.3"data-path="clipboard.en.html"><a href="clipboard.en.html">Clipboard</a></li><li class="open chapter"data-level="2.1.3.5.4"data-path="geolocation.en.html"><a href="geolocation.en.html">Geographical location</a></li><li class="open chapter"data-level="2.1.3.5.5"data-path="shortcut.en.html"><a href="shortcut.en.html">Home screen icons</a></li><li class="open chapter"data-level="2.1.3.5.6"data-path="calendar.en.html"><a href="calendar.en.html">Calendar events</a></li><li class="open chapter"data-level="2.1.3.5.7"data-path="network.en.html"><a href="network.en.html">Network status</a></li><li class="open chapter"data-level="2.1.3.5.8"data-path="device.en.html"><a href="device.en.html">Device information</a></li></ul></li><li class="open chapter"data-level="2.1.3.6"><a href="javascript:;">Graphics <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.6.1"data-path="media.en.html"><a href="media.en.html">Multimedia</a></li></ul></li><li class="open chapter"data-level="2.1.3.7"><a href="javascript:;">Vendor services <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.7.1"data-path="../service/push.en.html"><a href="../service/push.en.html">Push</a></li><li class="open chapter"data-level="2.1.3.7.2"data-path="../service/pay.en.html"><a href="../service/pay.en.html">Payments</a></li></ul></li><li class="open chapter"data-level="2.1.3.8"><a href="javascript:;">Third-party services <span class="icon icon-arrow"></span></a><ul class="articles"><li class="open chapter"data-level="2.1.3.8.1"data-path="../service/wxpay.en.html"><a href="../service/wxpay.en.html">WeChat Pay</a></li><li class="open chapter"data-level="2.1.3.8.2"data-path="../service/alipay.en.html"><a href="../service/alipay.en.html">Alipay</a></li><li class="open chapter"data-level="2.1.3.8.3"data-path="../service/share.en.html"><a href="../service/share.en.html">Sharing to a third party platform</a></li></ul></li></ul></nav><div class="doc-content"><div class="doc-content-inner"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><a href="#uploading-and-downloading-101"id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="uploading-and-downloading-101"><a href="#uploading-and-downloading-101"class="anchor-navigation-ex-anchor"name="uploading-and-downloading-101"><i class="fa fa-link"aria-hidden="true"></i></a>Uploading and downloading <code>101+</code></h1><h2 id="interface-declaration"><a href="#interface-declaration"class="anchor-navigation-ex-anchor"name="interface-declaration"><i class="fa fa-link"aria-hidden="true"></i></a>Interface declaration</h2><pre><code>{"name": "system.request"}
</code></pre><h2 id="import-module"><a href="#import-module"class="anchor-navigation-ex-anchor"name="import-module"><i class="fa fa-link"aria-hidden="true"></i></a>Import module</h2><pre><code>import request from '@system.request' or var request = require("@system.request")
</code></pre><h2 id="interface-definition"><a href="#interface-definition"class="anchor-navigation-ex-anchor"name="interface-definition"><i class="fa fa-link"aria-hidden="true"></i></a>Interface definition</h2><h3 id="requestuploadobject"><a href="#requestuploadobject"class="anchor-navigation-ex-anchor"name="requestuploadobject"><i class="fa fa-link"aria-hidden="true"></i></a>request.upload(OBJECT)</h3><p>Upload files</p><h4 id="parameters"><a href="#parameters"class="anchor-navigation-ex-anchor"name="parameters"><i class="fa fa-link"aria-hidden="true"></i></a>Parameters:</h4><table><thead><tr><th>Parameter name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>url</td><td>String</td><td>Yes</td><td>Resource URL</td></tr><tr><td>header</td><td>Object</td><td>No</td><td>The header requested, all its attributes will be set to the requested header's section. The useragent setting is invalid</td></tr><tr><td>method</td><td>String</td><td>No</td><td>The default is POST, it can be: POST, PUT</td></tr><tr><td>files</td><td>Array</td><td>Yes</td><td>The file list that needs to be uploaded, submitted using the "multipart/form-data" method</td></tr><tr><td>success</td><td>Function</td><td>No</td><td>The callback returned successfully</td></tr><tr><td>fail</td><td>Function</td><td>No</td><td>Failed callback</td></tr><tr><td>complete</td><td>Function</td><td>No</td><td>Ended callback (implemented whether the call fails or succeeds)</td></tr></tbody></table><h5 id="files-parameters"><a href="#files-parameters"class="anchor-navigation-ex-anchor"name="files-parameters"><i class="fa fa-link"aria-hidden="true"></i></a>Files parameters:</h5><p>The files parameter is an array of the file target, the file target structure is as follows:</p><table><thead><tr><th>Parameter name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>filename</td><td>String</td><td>No</td><td>The file name in the header when multipart is submitted</td></tr><tr><td>name</td><td>String</td><td>No</td><td>The form's project name when the multipart is submitted, default file</td></tr><tr><td>uri</td><td>String</td><td>Yes</td><td>Local address of the file</td></tr><tr><td>type</td><td>String</td><td>No</td><td>The content-type format of the file, by default it is obtained according to the suffix of the filename or URI</td></tr></tbody></table><h5 id="success-return-value"><a href="#success-return-value"class="anchor-navigation-ex-anchor"name="success-return-value"><i class="fa fa-link"aria-hidden="true"></i></a>Success return value:</h5><table><thead><tr><th>Parameter name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>code</td><td>Integer</td><td>Server status code</td></tr><tr><td>data</td><td>String</td><td>If the type in the header returned by the server is text/* or application/json, application/javascript, application/xml, the value is the text content; otherwise, it is the URI temp file of the saved temp file. If the content is an image or video, then they can be set to be displayed to the image or video control</td></tr><tr><td>headers</td><td>Object</td><td>All headers of the server response</td></tr></tbody></table><h4 id="example"><a href="#example"class="anchor-navigation-ex-anchor"name="example"><i class="fa fa-link"aria-hidden="true"></i></a>Example:</h4><pre><code>request.upload({
    "url": "http://www.example.com",
    "files": [
        {
            "uri": "internal://xxx/xxx/test",
            "name": "file1",
            "filename": "test.png"
        }
    ],
  　success:function(data){console.log("handling success");}
    fail: function(data, code) {
      console.log("handling fail, code=" + code);
    }
})
</code></pre><h3 id="requestdownloadobject"><a href="#requestdownloadobject"class="anchor-navigation-ex-anchor"name="requestdownloadobject"><i class="fa fa-link"aria-hidden="true"></i></a>request.download(OBJECT)</h3><p>Download files</p><h4 id="parameters_1"><a href="#parameters_1"class="anchor-navigation-ex-anchor"name="parameters_1"><i class="fa fa-link"aria-hidden="true"></i></a>Parameters:</h4><table><thead><tr><th>Parameter name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>url</td><td>String</td><td>Yes</td><td>Resource URL</td></tr><tr><td>header</td><td>String</td><td>No</td><td>The header requested, all its attributes will be set to the requested header's section. The useragent setting is invalid</td></tr><tr><td>success</td><td>Function</td><td>No</td><td>The callback returned successfully</td></tr><tr><td>fail</td><td>Function</td><td>No</td><td>Failed callback</td></tr><tr><td>complete</td><td>Function</td><td>No</td><td>Ended callback (implemented whether the call fails or succeeds)</td></tr></tbody></table><h5 id="success-return-value_1"><a href="#success-return-value_1"class="anchor-navigation-ex-anchor"name="success-return-value_1"><i class="fa fa-link"aria-hidden="true"></i></a>Success return value:</h5><table><thead><tr><th>Parameter name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>token</td><td>String</td><td>The downloaded token, get the download status according to this token</td></tr></tbody></table><h4 id="example_1"><a href="#example_1"class="anchor-navigation-ex-anchor"name="example_1"><i class="fa fa-link"aria-hidden="true"></i></a>Example:</h4><pre><code>request.download({
    "url": "http://www.example.com",
  　 success:function(data){console.log("handling success" + data.token);}
    fail: function(data, code) {
      console.log("handling fail, code=" + code);
    }
})
</code></pre><h3 id="requestondownloadcompleteobject"><a href="#requestondownloadcompleteobject"class="anchor-navigation-ex-anchor"name="requestondownloadcompleteobject"><i class="fa fa-link"aria-hidden="true"></i></a>request.onDownloadComplete(OBJECT)</h3><p>Monitor download tasks</p><h4 id="parameters_2"><a href="#parameters_2"class="anchor-navigation-ex-anchor"name="parameters_2"><i class="fa fa-link"aria-hidden="true"></i></a>Parameters:</h4><table><thead><tr><th>Parameter name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>token</td><td>String</td><td>Yes</td><td>Token returned by the download interface</td></tr><tr><td>success</td><td>Function</td><td>No</td><td>The callback returned successfully</td></tr><tr><td>fail</td><td>Function</td><td>No</td><td>Failed callback</td></tr><tr><td>complete</td><td>Function</td><td>No</td><td>Ended callback (implemented regardless of whether the call fails or succeeds)</td></tr></tbody></table><h5 id="success-return-value_2"><a href="#success-return-value_2"class="anchor-navigation-ex-anchor"name="success-return-value_2"><i class="fa fa-link"aria-hidden="true"></i></a>Success return value:</h5><table><thead><tr><th>Parameter name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>uri</td><td>String</td><td>URI of the downloaded file</td></tr></tbody></table><h5 id="fail-return-error-code"><a href="#fail-return-error-code"class="anchor-navigation-ex-anchor"name="fail-return-error-code"><i class="fa fa-link"aria-hidden="true"></i></a>Fail return error code:</h5><table><thead><tr><th>Error code</th><th>Description</th></tr></thead><tbody><tr><td>1000</td><td>Download failed</td></tr><tr><td>1001</td><td>Download task doesn't exist</td></tr></tbody></table><h4 id="example_2"><a href="#example_2"class="anchor-navigation-ex-anchor"name="example_2"><i class="fa fa-link"aria-hidden="true"></i></a>Example:</h4><pre><code>request.onDownloadComplete({
    "token": "123",
  　 success:function(data){
      console.log("handling success" + data.uri);
    }
    fail: function(data, code) {
      console.log("handling fail, code=" + code);
    }
})
</code></pre></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> 条匹配 "<span class="search-query"></span>" 的结果</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">没有搜索到与 "<span class="search-query"></span>" 相关的内容</h1></div></div></div></div></div><a href="fetch.en.html"class="navigation navigation-next navigation-unique"aria-label="Next page: Data request"><i class="fa fa-angle-right"></i></a></div></div><script src="../../gitbook/gitbook.js"></script><script src="../../gitbook/gitbook-plugin-hap-util/plugin.js"></script><script src="../../gitbook/gitbook-plugin-nocache/nocache.js"></script><script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script><script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script><script>gitbook.page.hasChanged({page:{title:"Uploading and downloading",level:"2.1.3.3.1",depth:4,next:{title:"Data request",level:"2.1.3.3.2",depth:4,path:"features/system/fetch.en.md",ref:"features/system/fetch.en.md",articles:[]},previous:{title:"Network access",level:"2.1.3.3",depth:3,ref:"",articles:[{title:"Uploading and downloading",level:"2.1.3.3.1",depth:4,path:"features/system/request.en.md",ref:"features/system/request.en.md",articles:[]},{title:"Data request",level:"2.1.3.3.2",depth:4,path:"features/system/fetch.en.md",ref:"features/system/fetch.en.md",articles:[]}]},dir:"ltr"},config:{plugins:["html-minifier","-sharing","-fontsettings","hap-util","favicon","theme-default","nocache","-lunr","-search","search-pro","-highlight","highlight-hap","anchor-navigation-ex"],styles:{website:"styles/website.css"},pluginsConfig:{favicon:{shortcut:"",bookmark:""},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!0,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},"anchor-navigation-ex":{associatedWithSummary:!1,float:{floatIcon:"fa fa-navicon",level1Icon:"",level2Icon:"",level3Icon:"",showLevelIcon:!1},mode:"",multipleH1:!0,pageTop:{level1Icon:"",level2Icon:"",level3Icon:"",showLevelIcon:!1},printLog:!1,showGoTop:!0,showLevel:!1},"hap-util":{},nocache:{},"search-pro":{},"highlight-hap":{},"theme-default":{showLevel:!1,styles:{ebook:"styles/ebook.css",epub:"styles/epub.css",mobi:"styles/mobi.css",pdf:"styles/pdf.css",print:"styles/print.css",website:"styles/website.css"}}},theme:"default",author:"QuickApp.cn",pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},variables:{},version:"{{datetime}}",title:"快应用开发文档",language:"zh-hans",gitbook:"3.2.3",description:"快应用的开发文档，供快应用开发者学习和参考"},file:{path:"features/system/request.en.md",mtime:"2020-09-23T10:05:42.000Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2021-08-05T12:05:05.723Z"},basePath:"../..",book:{language:""}}),function(){var e=location.pathname.split("/")[1];e!=(sessionStorage.getItem("indexTab")||"")&&sessionStorage.setItem("mst",0),~location.pathname.indexOf(".html")||sessionStorage.setItem("mst",0),sessionStorage.setItem("indexTab",e);var t=$(".doc-menu"),s=$(".summary");if(!(t.height()>s.height()&&0!==s.height())){t.scroll(function(){sessionStorage.setItem("mst",t.scrollTop())});var a=sessionStorage.getItem("mst")||0;t.scrollTop(a),$("ul.summary li").each(function(){var e=$(this);10<e.data("level").length&&(e.hasClass("active")?e.parent().parent().attr("class","open chapter cur"):e.parent().parent().siblings().each(function(){var e=$(this);!e.hasClass("cur")&&e.hasClass("open chapter")&&e.attr("class","chapter")}))})}}()</script></body></html>